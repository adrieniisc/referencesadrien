<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ReferencesAdrien</title>
  <style>
    /* --------------------------------------------------
       Inverted Color Variables
       - Main area: lighter background (#ffffff) and dark text (#1c1c1e)
       - Sidebar: dark background (#000000) with light text (#f2f2f7)
    -------------------------------------------------- */
    :root {
      --main-bg: #232323;
      /* main area */
      --main-text: #f2f2f7;
      /* text for main area */
      --side-bg: #171717;
      /* sidebar */
      --side-text: #f2f2f7;
      /* text for sidebar */
      --border-color: #3a3a3c;
      --highlight-color: #555555;
      --thumbnail-size: 360px;
    }

    /* --------------------------------------------------
       Base Reset & Body
    -------------------------------------------------- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    }

    body {
      display: flex;
      flex-direction: column;
      color: var(--main-text);
      background-color: var(--main-bg);
    }

    /* --------------------------------------------------
       Header Styles
    -------------------------------------------------- */
    header {
      background-color: var(--side-bg);
      /* Match sidebar background */
      color: var(--side-text);
      /* Match sidebar text color */
      border-bottom: 1px solid var(--border-color);
      /* Add a border to separate header */
      padding: 0.5rem;
      /* Adjust padding as needed */
      display: flex;
      align-items: center;
      /* Center items vertically */
    }

    #search-bar {
      flex: 1;
      /* Allow search bar to grow */
      margin-right: 1rem;
      /* Add spacing between search and admin button */
    }

    #admin-access-btn {
      /* Style admin button */
      background-color: var(--highlight-color);
      color: var(--side-text);
      border: none;
      padding: 0.5rem 1rem;
      cursor: pointer;
    }

    /* --------------------------------------------------
       Main Content Area
    -------------------------------------------------- */
    .main-container {
      flex: 1;
      /* Allow this section to take up the remaining space */
      display: flex;
      overflow: hidden;
    }

    /* --------------------------------------------------
       Sidebar Styles
    -------------------------------------------------- */
    .sidebar {
      width: fit-content;
      min-width: 220px;
      background-color: var(--side-bg);
      border-right: 1px solid var(--border-color);
      padding: 0.8rem;
      display: flex;
      flex-direction: column;
      color: var(--side-text);
      height: 100%;
      /* Sidebar takes the full height of the main container */
    }

    .folder-list {
      list-style-type: none;
      padding: 0;
    }

    .folder-list li {
      padding: 0.5rem;
      cursor: pointer;
      border-bottom: 1px solid var(--border-color);
    }

    .folder-list li.selected {
      background-color: var(--highlight-color);
    }

    .admin-controls {
      margin-top: 1rem;
    }

    .admin-controls button {
      background-color: var(--highlight-color);
      color: var(--side-text);
      border: none;
      padding: 0.5rem 1rem;
      cursor: pointer;
      display: none;
      /* Hidden by default, shown on admin login */
    }

    .separator {
      height: 1px;
      background-color: var(--border-color);
      margin: 0.5rem 0;
      display: none;
      /* Hidden by default, shown on admin login */
    }

    /* --------------------------------------------------
       Main Content Styles
    -------------------------------------------------- */
    .content {
      flex: 1;
      /* Allow the content area to take up remaining space */
      overflow-y: auto;
      /* Add scroll if content overflows */
      padding: 0.5rem;
    }

    .image-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(var(--thumbnail-size), 1fr));
      gap: 0.5rem;
    }

    .image-container {
      position: relative;
    }

    .delete-btn,
    .move-btn {
      position: absolute;
      top: 0.25rem;
      right: 0.25rem;
      background-color: rgba(0, 0, 0, 0.5);
      color: var(--side-text);
      border: none;
      padding: 0.25rem 0.5rem;
      cursor: pointer;
      display: none;
      /* Hidden by default, shown on admin login */
    }

    .move-btn {
      right: 2.5rem;
    }

    /* --------------------------------------------------
       Floating Size Panel
    -------------------------------------------------- */
    #size-panel {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      background-color: var(--side-bg);
      border: 1px solid var(--border-color);
      padding: 0.5rem;
      display: flex;
      gap: 0.5rem;
    }

    #size-panel img {
      width: 24px;
      height: 24px;
      cursor: pointer;
    }

    /* --------------------------------------------------
       Modals
    -------------------------------------------------- */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: none;
      /* Hidden by default */
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background-color: var(--side-bg);
      border: 1px solid var(--border-color);
      padding: 1rem;
      min-width: 300px;
    }

    .modal-content h2 {
      margin-bottom: 1rem;
    }

    .modal-content input {
      width: 100%;
      padding: 0.5rem;
      margin-bottom: 1rem;
    }

    .modal-content button {
      background-color: var(--highlight-color);
      color: var(--side-text);
      border: none;
      padding: 0.5rem 1rem;
      cursor: pointer;
    }

    .modal.active {
      display: flex;
      /* Show modal when active */
    }
  </style>
</head>

<body>
  <header>
    <input type="text" id="search-bar" placeholder="Search images..." />
    <button id="admin-access-btn">Admin Access</button>
  </header>

  <div class="main-container">
    <aside class="sidebar">
      <ul class="folder-list">
        <li data-filter="all">All</li>
      </ul>
      <div class="admin-controls">
        <button id="add-folder-btn">Add Folder</button>
        <button id="add-image-btn">Add Image</button>
        <div class="separator"></div>
        <button id="rename-folder-btn">Rename Folder</button>
        <div class="separator"></div>
        <button id="move-image-btn">Move Image</button>
      </div>
    </aside>

    <main class="content">
      <div class="image-grid">
        </div>
    </main>
  </div>

  <div id="size-panel">
    <img src="icons/small.png" alt="Small" data-size="180" />
    <img src="icons/medium.png" alt="Medium" data-size="260" />
    <img src="icons/large.png" alt="Large" data-size="360" />
  </div>

  <div id="add-folder-modal" class="modal">
    <div class="modal-content">
      <h2>Add New Folder</h2>
      <input type="text" id="new-folder-name" placeholder="Enter folder name" />
      <button id="confirm-add-folder">Confirm</button>
      <button id="close-add-folder-modal">Cancel</button>
    </div>
  </div>

  <div id="add-image-modal" class="modal">
    <div class="modal-content">
      <h2>Add New Image</h2>
      <input type="file" id="image-upload" accept="image/*" />
      <input type="text" id="image-name" placeholder="Enter image name" />
      <select id="image-folder-select"></select>
      <button id="confirm-add-image">Confirm</button>
      <button id="close-add-image-modal">Cancel</button>
    </div>
  </div>

  <div id="rename-folder-modal" class="modal">
    <div class="modal-content">
      <h2>Rename Folder</h2>
      <select id="folder-select"></select>
      <input type="text" id="rename-folder-name" placeholder="Enter new folder name" />
      <button id="confirm-rename-folder">Confirm</button>
      <button id="close-rename-folder-modal">Cancel</button>
    </div>
  </div>

  <div id="move-image-modal" class="modal">
    <div class="modal-content">
      <h2>Move Image</h2>
      <select id="image-select"></select>
      <select id="destination-folder-select"></select>
      <button id="confirm-move-image">Confirm</button>
      <button id="close-move-image-modal">Cancel</button>
    </div>
  </div>

  <div id="admin-modal" class="modal">
    <div class="modal-content">
      <h2>Admin Login</h2>
      <input type="password" id="admin-password-input" placeholder="Enter admin password" />
      <button id="confirm-admin-btn">Login</button>
      <button id="close-admin-modal-btn">Cancel</button>
    </div>
  </div>

  <script>
    // DOM Elements
    const folderList = document.querySelector(".folder-list");
    const imageGrid = document.querySelector(".image-grid");
    const addFolderBtn = document.querySelector("#add-folder-btn");
    const addImageBtn = document.querySelector("#add-image-btn");
    const renameFolderBtn = document.querySelector("#rename-folder-btn");
    const moveImageBtn = document.querySelector("#move-image-btn");
    const addFolderModal = document.querySelector("#add-folder-modal");
    const addImageModal = document.querySelector("#add-image-modal");
    const renameFolderModal = document.querySelector("#rename-folder-modal");
    const moveImageModal = document.querySelector("#move-image-modal");
    const closeAddFolderModalBtn = document.querySelector("#close-add-folder-modal");
    const confirmAddFolderBtn = document.querySelector("#confirm-add-folder");
    const closeAddImageModalBtn = document.querySelector("#close-add-image-modal");
    const confirmAddImageBtn = document.querySelector("#confirm-add-image");
    const closeRenameFolderModalBtn = document.querySelector("#close-rename-folder-modal");
    const confirmRenameFolderBtn = document.querySelector("#confirm-rename-folder");
    const closeMoveImageModalBtn = document.querySelector("#close-move-image-modal");
    const confirmMoveImageBtn = document.querySelector("#confirm-move-image");
    const newFolderNameInput = document.querySelector("#new-folder-name");
    const imageUploadInput = document.querySelector("#image-upload");
    const imageNameInput = document.querySelector("#image-name");
    const folderSelect = document.querySelector("#folder-select");
    const renameFolderNameInput = document.querySelector("#rename-folder-name");
    const imageSelect = document.querySelector("#image-select");
    const destinationFolderSelect = document.querySelector("#destination-folder-select");
    const sizePanel = document.querySelector("#size-panel");
    const adminAccessBtn = document.querySelector("#admin-access-btn");
    const adminModal = document.querySelector("#admin-modal");
    const closeAdminModalBtn = document.querySelector("#close-admin-modal-btn");
    const confirmAdminBtn = document.querySelector("#confirm-admin-btn");
    const adminPasswordInput = document.querySelector("#admin-password-input");
    const editButtons = document.querySelectorAll(".admin-controls button");
    const separators = document.querySelectorAll(".separator");
    const searchBar = document.querySelector("#search-bar");

    let images = [];
    let folders = [];
    let currentFolderFilter = "all";

    // --- Firebase Initialization (Placeholder) ---
    // Replace with your actual Firebase initialization code
    const initializeFirebase = () => {
      console.log("Firebase initialized (placeholder)");
      // Your Firebase initialization code here
    };

    // --- Firebase Functions (Placeholders) ---
    // Replace with your actual Firebase database interaction code

    const loadFoldersFromFirebase = async () => {
      console.log("Loading folders from Firebase (placeholder)");
      folders = [{ id: "all", name: "All" }, { id: "folder1", name: "Folder 1" }, { id: "folder2", name: "Folder 2" }]; // Example data
      populateFolderList();
      populateFolderSelects();
    };

    const loadImagesFromFirebase = async () => {
      console.log("Loading images from Firebase (placeholder)");
      images = [
        { id: "image1", name: "Image 1", url: "placeholder_image_url.jpg", folderId: "folder1" },
        { id: "image2", name: "Image 2", url: "placeholder_image_url.jpg", folderId: "folder2" },
        { id: "image3", name: "Image 3", url: "placeholder_image_url.jpg", folderId: "folder1" },
      ]; // Example data
      displayImages(currentFolderFilter);
    };

    const addFolderToFirebase = async (folderName) => {
      console.log("Adding folder to Firebase (placeholder):", folderName);
      const newFolder = { id: "newFolderId", name: folderName }; // Example data
      folders.push(newFolder);
      populateFolderList();
      populateFolderSelects();
    };

    const addImageToFirebase = async (imageFile, imageName, folderId) => {
      console.log("Adding image to Firebase (placeholder):", imageName, folderId);
      // Upload file to Firebase Storage, get URL
      const imageUrl = "placeholder_image_url.jpg"; // Replace with actual URL
      const newImage = { id: "newImageId", name: imageName, url: imageUrl, folderId: folderId }; // Example data
      images.push(newImage);
      displayImages(currentFolderFilter);
    };

    const renameFolderInFirebase = async (folderId, newFolderName) => {
      console.log("Renaming folder in Firebase (placeholder):", folderId, newFolderName);
      const folder = folders.find((f) => f.id === folderId);
      if (folder) {
        folder.name = newFolderName;
        populateFolderList();
        populateFolderSelects();
      }
    };

    const moveImageInFirebase = async (imageId, newFolderId) => {
      console.log("Moving image in Firebase (placeholder):", imageId, newFolderId);
      const image = images.find((i) => i.id === imageId);
      if (image) {
        image.folderId = newFolderId;
      }
    };

    const deleteImageFromFirebase = async (imageId) => {
      console.log("Deleting image from Firebase (placeholder):", imageId);
      images = images.filter((image) => image.id !== imageId);
      displayImages(currentFolderFilter);
    };

    // --- UI Population Functions ---

    const populateFolderList = () => {
      folderList.innerHTML = "";
      folders.forEach((folder) => {
        const li = document.createElement("li");
        li.textContent = folder.name;
        li.dataset.filter = folder.id;
        li.addEventListener("click", () => {
          currentFolderFilter = folder.id;
          displayImages(currentFolderFilter);
          document.querySelectorAll(".folder-list li").forEach((item) => item.classList.remove("selected"));
          li.classList.add("selected");
        });
        folderList.appendChild(li);
      });
    };

    const populateFolderSelects = () => {
      folderSelect.innerHTML = "";
      destinationFolderSelect.innerHTML = "";
      imageFolderSelect.innerHTML = "";

      folders.forEach((folder) => {
        const option1 = document.createElement("option");
        option1.value = folder.id;
        option1.textContent = folder.name;
        folderSelect.appendChild(option1);

        const option2 = document.createElement("option");
        option2.value = folder.id;
        option2.textContent = folder.name;
        destinationFolderSelect.appendChild(option2);

        const option3 = document.createElement("option");
        option3.value = folder.id;
        option3.textContent = folder.name;
        imageFolderSelect.appendChild(option3);
      });
    };

    const populateImageSelect = () => {
      imageSelect.innerHTML = "";
      images.forEach((image) => {
        const option = document.createElement("option");
        option.value = image.id;
        option.textContent = image.name;
        imageSelect.appendChild(option);
      });
    };

    const displayImages = (folderId) => {
      imageGrid.innerHTML = "";
      const filteredImages = folderId === "all" ? images : images.filter((image) => image.folderId === folderId);
      filteredImages.forEach((image) => {
        const imageContainer = document.createElement("div");
        imageContainer.classList.add("image-container");

        const img = document.createElement("img");
        img.src = image.url;
        img.alt = image.name;

        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "Delete";
        deleteBtn.classList.add("delete-btn");
        deleteBtn.addEventListener("click", () => {
          deleteImageFromFirebase(image.id);
        });

        const moveBtn = document.createElement("button");
        moveBtn.textContent = "Move";
        moveBtn.classList.add("move-btn");
        moveBtn.addEventListener("click", () => {
          moveImageModal.classList.add("active");
          populateImageSelect();
          populateFolderSelects();
          moveImageSelect.value = image.id;
        });

        imageContainer.appendChild(img);
        imageContainer.appendChild(deleteBtn);
        imageContainer.appendChild(moveBtn);
        imageGrid.appendChild(imageContainer);
      });
    };

    // --- Event Listeners ---

    // Folder Modals
    addFolderBtn.addEventListener("click", () => {
      addFolderModal.classList.add("active");
    });

    closeAddFolderModalBtn.addEventListener("click", () => {
      addFolderModal.classList.remove("active");
    });

    confirmAddFolderBtn.addEventListener("click", () => {
      const folderName = newFolderNameInput.value;
      if (folderName) {
        addFolderToFirebase(folderName);
        addFolderModal.classList.remove("active");
        newFolderNameInput.value = "";
      }
    });

    // Image Modals
    addImageBtn.addEventListener("click", () => {
      addImageModal.classList.add("active");
      populateFolderSelects();
    });

    closeAddImageModalBtn.addEventListener("click", () => {
      addImageModal.classList.remove("active");
    });

    confirmAddImageBtn.addEventListener("click", () => {
      const imageFile = imageUploadInput.files[0];
      const imageName = imageNameInput.value;
      const folderId = imageFolderSelect.value;
      if (imageFile && imageName && folderId) {
        addImageToFirebase(imageFile, imageName, folderId);
        addImageModal.classList.remove("active");
        imageUploadInput.value = "";
        imageNameInput.value = "";
      }
    });

    // Rename Folder Modals
    renameFolderBtn.addEventListener("click", () => {
      renameFolderModal.classList.add("active");
      populateFolderSelects();
    });

    closeRenameFolderModalBtn.addEventListener("click", () => {
      renameFolderModal.classList.remove("active");
    });

    confirmRenameFolderBtn.addEventListener("click", () => {
      const folderId = folderSelect.value;
      const newFolderName = renameFolderNameInput.value;
      if (newFolderName) {
        renameFolderInFirebase(folderId, newFolderName);
        renameFolderModal.classList.remove("active");
        renameFolderNameInput.value = "";
      }
    });

    // Move Image Modals
    moveImageBtn.addEventListener("click", () => {
      moveImageModal.classList.add("active");
      populateImageSelect();
      populateFolderSelects();
    });

    closeMoveImageModalBtn.addEventListener("click", () => {
      moveImageModal.classList.remove("active");
    });

    confirmMoveImageBtn.addEventListener("click", () => {
      const imageId = imageSelect.value;
      const newFolderId = destinationFolderSelect.value;
      moveImageInFirebase(imageId, newFolderId);
      moveImageModal.classList.remove("active");
    });

    // Size Panel
    sizePanel.querySelectorAll("img").forEach((icon) => {
      icon.addEventListener("click", () => {
        const newSize = icon.getAttribute("data-size");
        document.documentElement.style.setProperty("--thumbnail-size", newSize + "px");
      });
    });

    // ADMIN Login Event Listeners (using the sidebar admin button)
    adminAccessBtn.addEventListener("click", () => {
      adminModal.classList.add("active");
    });

    closeAdminModalBtn.addEventListener("click", () => {
      adminModal.classList.remove("active");
    });

    confirmAdminBtn.addEventListener("click", () => {
      const correctPassword = "admin123"; // Change as needed
      if (adminPasswordInput.value === correctPassword) {
        editButtons.forEach((button) => {
          button.style.display = "block";
        });
        separators.forEach((separator) => {
          separator.style.display = "block";
        });
        adminModal.classList.remove("active");
      } else {
        alert("Incorrect password. Please try again.");
      }
    });

    document.addEventListener("DOMContentLoaded", async () => {
      try {
        console.log("DOM loaded, initializing application...");
        // Initialize Firebase (Placeholder)
        initializeFirebase();
        await loadFoldersFromFirebase();
        await loadImagesFromFirebase();
        const allFolder = document.querySelector('.folder-list li[data-filter="all"]');
        if (allFolder) {
          allFolder.classList.add("selected");
        }
        console.log("App initialized successfully!");
      } catch (error) {
        console.error("Error initializing app:", error);
        alert("Error initializing app: " + error.message);
      }
    });
  </script>
</body>

</html>